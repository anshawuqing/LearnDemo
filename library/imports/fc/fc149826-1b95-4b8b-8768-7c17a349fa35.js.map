{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\Star.js"],"names":["cc","Class","extends","Component","properties","pickRadius","onLoad","start","getPlayerDistance","playerPos","game","player","getPosition","dist","node","position","sub","mag","console","log","onPicked","spawnNewStar","gainScore","destroy","update","dt","opacityRatio","timer","starDuration","minOpactiy","opacity","Math","floor"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,WAASF,GAAGG,SADP;;AAGLC,cAAY;;AAER;AACAC,gBAAY;;AAHJ,GAHP;AASL;;AAECC,UAAQ,kBACR,CAEC,CAdG;;AAgBLC,OAhBK,mBAgBI,CAER,CAlBI;;;AAoBL;AACAC,qBAAoB,6BACpB;AACE;AACA,QAAIC,YAAY,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,WAAjB,EAAhB;;AAEA;AACA,QAAIC,OAAO,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBP,SAAvB,EAAkCQ,GAAlC,EAAX;AACAC,YAAQC,GAAR,CAAY,kBAAgBN,IAA5B;AACA,WAAOA,IAAP;AACD,GA9BI;;AAgCL;AACCO,YAAS,oBACT;AACG;AACA,SAAKV,IAAL,CAAUW,YAAV;AACD;AACA;AACA,SAAKX,IAAL,CAAUY,SAAV;AACC;AACA,SAAKR,IAAL,CAAUS,OAAV;AAEF,GA3CG;;AA6CJC,UAAS,gBAAUC,EAAV,EACT;AACG;AACD,QAAG,KAAKjB,iBAAL,KAA0B,KAAKH,UAAlC,EACA;AACCa,cAAQC,GAAR,CAAY,OAAZ;AACC;AACD,WAAKC,QAAL;AACE;AACF;;AAED;AACA,QAAKM,eAAgB,IAAI,KAAKhB,IAAL,CAAUiB,KAAV,GAAgB,KAAKjB,IAAL,CAAUkB,YAAnD;AACA,QAAIC,aAAc,EAAlB;AACA,SAAKf,IAAL,CAAUgB,OAAV,GAAqBD,aAAaE,KAAKC,KAAL,CAAWN,gBAAc,MAAMG,UAApB,CAAX,CAAlC;AACD;AA5DG,CAAT","file":"Star.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    \r\n        ///当星星 和主角之间的距离小于这个 数值时就会完成收集\r\n        pickRadius: 0,\r\n \r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    \r\n     onLoad: function () \r\n     {\r\n\r\n     },\r\n\r\n    start () {\r\n\r\n    },\r\n \r\n    ///得到和 主角之间的距离\r\n    getPlayerDistance : function ()\r\n    {\r\n      //根据 player 节点位置 判断距离\r\n      var playerPos = this.game.player.getPosition(); \r\n    \r\n      // 根据 2 点位置 计算 2点之间距离\r\n      var dist = this.node.position.sub(playerPos).mag();\r\n      console.log(\"小星星距离————————\"+dist);\r\n      return dist; \r\n    },\r\n     \r\n    ///星星的回收行为\r\n     onPicked:function()\r\n     {\r\n        //当星星被收集时，调用 Game 中的接口生成一个新的星星\r\n        this.game.spawnNewStar();\r\n       // spawnNewStar\r\n       // 调用收集的信息\r\n       this.game.gainScore();\r\n        //然后销毁 当前星星节点\r\n        this.node.destroy();\r\n        \r\n     },\r\n    \r\n     update : function (dt) \r\n     {\r\n        //每帧判断  和主角 之间的距离 是否小于收集距离\r\n       if(this.getPlayerDistance()< this.pickRadius )\r\n       {\r\n        console.log(\"看到小星星\");\r\n         //调用 收集行为\r\n        this.onPicked();\r\n          return ;\r\n       }\r\n\r\n       //根据脚本中的 计时器更新星星的透明度\r\n       var  opacityRatio =  1 - this.game.timer/this.game.starDuration;\r\n       var minOpactiy  = 50;\r\n       this.node.opacity =  minOpactiy+  Math.floor(opacityRatio*(255 - minOpactiy)); \r\n     },\r\n});\r\n"]}